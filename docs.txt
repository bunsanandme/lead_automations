ЗНАЧЕНИЕ ФАЙЛОВ:
В репозитории файл:
config.yaml - открывается блокнотом. Файл сериализации и задания логин/пароль почты, а также путей до документов
firm.db - База данных в SQLite3

sql.py - все функции для работы с БД. Выполняют SELECT, INSERT и получение данных о клиенте
imap.py - все функции для просмотра почты, выделение входящих и автоматический ответ
smtp.py - все функции для отправки сообщений клиентам насчет документов и встреч

setup.py - файл для создания exe сборки 

База данных соответствует схеме, которую я скидывал

SQL.PY

В начале каждого файла функций загружаются конфиги из файла и проверяются на корректность путей и логинов
LOG_SYMBOL служит обозначает системные сообщения при отладке
DEBUG - флаг отладки

query_executor_select(query)
Функция исполняет SELECT запрос к БД. Возвращает все строки запроса. Здесь также идет проверка на корректность подключения,
если не так, то возвращает ничего

query_executor_insert(query)
Функция исполняет запрос, изменяющий БД(INSERT,UPDATE). Также проверяет корректность подключения

get_client_data(client_email)
Частный случай SELECT, принимающий email возвращает имя, тип лида. Также проверяет корректность подключения

IMAP.PY

get_headers_email(email_numbers,read_mode)
Функция подключает к IMAP-серверу, в зависимости от почты, и возвращает определенное кол-во писем
Внутри идет дешифровка письма и темы, если нет темы, то добавляет пустую строку
read_mode показывает, что именно мы будем возвращать
ALL - возвращает адрес, дату, тему письма, id
E_ONLY - возвращает список адресов

read_work_email()
Функция для автоматического ответа на письма с приложенным определенным файлом
В цикле email проверяется наличие вложений и определенной темой.
При наличии таковых, БД заполняется полностью данным из документа WORD(изначально часть заполняется при отправке)

SMTP.PY
send_client_message(to_email)
При помощи SMTP сервера функция отправляет сообщения с разным содержанием в зависимости от типа лида.
Формы писем берутся из папки email_forms, образцы документов из папки documents
M - отправляется приветственная форма с данными о клиенте, добавляется новая запись в БД
L - отправляется форма о заключении сделки, добавляется в документ-образец приоритетный свободный поставщик и транспортная компания
Заносится новая запись


send_client_meeting(to_email, date, address)
Аналогичная функция отправки приглашений на встречу, по умолчанию дата сегодняшняя и адрес офиса. Также при отправке добавляется 
запись в БД.


MAIN.PY
В этом файле можно проверить работу функций



 